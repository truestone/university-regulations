<%= form_with model: [conversation, message], 
    local: false, 
    data: { 
      turbo_stream: true, 
      chat_target: "form",
      action: "turbo:submit-end->chat#scrollToBottom"
    },
    class: "bg-white dark:bg-gray-800 rounded-lg shadow-chat border border-gray-200 dark:border-gray-700 p-4 sm:p-6 transition-all" do |form| %>
  
  <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
    <div class="flex-1">
      <%= form.text_area :content, 
          placeholder: "규정에 대해 궁금한 것을 물어보세요...", 
          rows: 3,
          class: "w-full p-3 sm:p-4 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:focus:ring-primary-400 dark:focus:border-primary-400 resize-none transition-all placeholder-gray-500 dark:placeholder-gray-400",
          data: { 
            chat_target: "input",
            action: "keydown->chat#handleKeydown"
          },
          required: true %>
      
      <% if message.errors.any? %>
        <div class="mt-3 p-3 bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg">
          <div class="flex">
            <svg class="w-5 h-5 text-red-400 dark:text-red-300" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
            </svg>
            <div class="ml-3">
              <% message.errors.full_messages.each do |error| %>
                <p class="text-sm text-red-800 dark:text-red-200"><%= error %></p>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    
    <div class="flex flex-col justify-end space-y-2">
      <%= form.submit "전송", 
          class: "inline-flex items-center justify-center px-6 py-3 text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 dark:focus:ring-primary-800 rounded-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",
          data: { 
            chat_target: "submit",
            disable_with: "전송 중..."
          } %>
      
      <div class="text-xs text-gray-500 dark:text-gray-400 text-center">
        <kbd class="px-2 py-1 text-xs font-semibold text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded">Ctrl</kbd>
        +
        <kbd class="px-2 py-1 text-xs font-semibold text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded">Enter</kbd>
        로 전송
      </div>
    </div>
  </div>
<% end %>